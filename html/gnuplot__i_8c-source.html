<html>
<head>
<meta name="author"             content="ndevilla@free.fr">
<meta name="editor"             content="ndevilla@free.fr">
<meta name="maintainer"         content="ndevilla@free.fr">
<meta name="keywords"           content="gnuplot, interface, ANSI C">
<link href="doxygen.css" rel="stylesheet" type="text/css">
<title>gnuplot_i 2.x</title>
</head>

<body text="#000000" bgcolor="#ffffff">

<!-- Generated by Doxygen 1.2.17 -->
<h1>gnuplot_i.c</h1><a href="gnuplot__i_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00003 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00017 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00018 
00019 <span class="comment">/*</span>
00020 <span class="comment">    $Id: gnuplot_i.c,v 2.10 2003/01/27 08:58:04 ndevilla Exp $</span>
00021 <span class="comment">    $Author: ndevilla $</span>
00022 <span class="comment">    $Date: 2003/01/27 08:58:04 $</span>
00023 <span class="comment">    $Revision: 2.10 $</span>
00024 <span class="comment"> */</span>
00025 
00026 <span class="comment">/*---------------------------------------------------------------------------</span>
00027 <span class="comment">                                Includes</span>
00028 <span class="comment"> ---------------------------------------------------------------------------*/</span>
00029 
00030 <span class="preprocessor">#include "<a class="code" href="gnuplot__i_8h.html">gnuplot_i.h</a>"</span>
00031 
00032 <span class="comment">/*---------------------------------------------------------------------------</span>
00033 <span class="comment">                                Defines</span>
00034 <span class="comment"> ---------------------------------------------------------------------------*/</span>
00035 
00037 <span class="preprocessor">#define GP_CMD_SIZE         2048</span>
00038 <span class="preprocessor"></span>
00039 <span class="preprocessor">#define GP_TITLE_SIZE       80</span>
00040 <span class="preprocessor"></span>
00041 <span class="preprocessor">#define GP_EQ_SIZE          512</span>
00042 <span class="preprocessor"></span>
00043 <span class="preprocessor">#define PATH_MAXNAMESZ       4096</span>
00044 <span class="preprocessor"></span>
00046 <span class="preprocessor">#ifndef P_tmpdir</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#define P_tmpdir "."</span>
00048 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00049 <span class="preprocessor"></span>
00050 <span class="comment">/*---------------------------------------------------------------------------</span>
00051 <span class="comment">                            Function codes</span>
00052 <span class="comment"> ---------------------------------------------------------------------------*/</span>
00053 
00054 
00055 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00083 <span class="comment">/*-------------------------------------------------------------------------*/</span>
<a name="l00084"></a><a class="code" href="gnuplot__i_8c.html#a0">00084</a> <span class="keywordtype">char</span> * <a class="code" href="gnuplot__i_8c.html#a0">gnuplot_get_program_path</a>(<span class="keywordtype">char</span> * pname)
00085 {
00086     <span class="keywordtype">int</span>         i, j, lg;
00087     <span class="keywordtype">char</span>    *   path;
00088     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[PATH_MAXNAMESZ];
00089 
00090     <span class="comment">/* Trivial case: try in CWD */</span>
00091     sprintf(buf, <span class="stringliteral">"./%s"</span>, pname) ;
00092     <span class="keywordflow">if</span> (access(buf, X_OK)==0) {
00093         sprintf(buf, <span class="stringliteral">"."</span>);
00094         <span class="keywordflow">return</span> buf ;
00095     }
00096     <span class="comment">/* Try out in all paths given in the PATH variable */</span>
00097     buf[0] = 0;
00098     path = getenv(<span class="stringliteral">"PATH"</span>) ;
00099     <span class="keywordflow">if</span> (path!=NULL) {
00100         <span class="keywordflow">for</span> (i=0; path[i]; ) {
00101             <span class="keywordflow">for</span> (j=i ; (path[j]) &amp;&amp; (path[j]!=<span class="charliteral">':'</span>) ; j++);
00102             lg = j - i;
00103             strncpy(buf, path + i, lg);
00104             <span class="keywordflow">if</span> (lg == 0) buf[lg++] = <span class="charliteral">'.'</span>;
00105             buf[lg++] = <span class="charliteral">'/'</span>;
00106             strcpy(buf + lg, pname);
00107             <span class="keywordflow">if</span> (access(buf, X_OK) == 0) {
00108                 <span class="comment">/* Found it! */</span>
00109                 <span class="keywordflow">break</span> ;
00110             }
00111             buf[0] = 0;
00112             i = j;
00113             <span class="keywordflow">if</span> (path[i] == <span class="charliteral">':'</span>) i++ ;
00114         }
00115     } <span class="keywordflow">else</span> {
00116         fprintf(stderr, <span class="stringliteral">"PATH variable not set\n"</span>);
00117     }
00118     <span class="comment">/* If the buffer is still empty, the command was not found */</span>
00119     <span class="keywordflow">if</span> (buf[0] == 0) <span class="keywordflow">return</span> NULL ;
00120     <span class="comment">/* Otherwise truncate the command name to yield path only */</span>
00121     lg = strlen(buf) - 1 ;
00122     <span class="keywordflow">while</span> (buf[lg]!=<span class="charliteral">'/'</span>) {
00123         buf[lg]=0 ;
00124         lg -- ;
00125     }
00126     buf[lg] = 0;
00127     <span class="keywordflow">return</span> buf ;
00128 }
00129 
00130 
00131 
00132 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00143 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00144 
<a name="l00145"></a><a class="code" href="gnuplot__i_8c.html#a1">00145</a> <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * <a class="code" href="gnuplot__i_8c.html#a1">gnuplot_init</a>(<span class="keywordtype">void</span>)
00146 {
00147     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> *  handle ;
00148 
00149     <span class="keywordflow">if</span> (getenv(<span class="stringliteral">"DISPLAY"</span>) == NULL) {
00150         fprintf(stderr, <span class="stringliteral">"cannot find DISPLAY variable: is it set?\n"</span>) ;
00151     }
00152     <span class="keywordflow">if</span> (<a class="code" href="gnuplot__i_8c.html#a0">gnuplot_get_program_path</a>(<span class="stringliteral">"gnuplot"</span>)==NULL) {
00153         fprintf(stderr, <span class="stringliteral">"cannot find gnuplot in your PATH"</span>);
00154         <span class="keywordflow">return</span> NULL ;
00155     }
00156 
00157     <span class="comment">/* </span>
00158 <span class="comment">     * Structure initialization:</span>
00159 <span class="comment">     */</span>
00160     handle = (<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>)) ;
00161     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> = 0 ;
00162     <a class="code" href="gnuplot__i_8c.html#a4">gnuplot_setstyle</a>(handle, <span class="stringliteral">"points"</span>) ;
00163     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> = 0 ;
00164 
00165     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m0">gnucmd</a> = popen(<span class="stringliteral">"gnuplot"</span>, <span class="stringliteral">"w"</span>) ;
00166     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m0">gnucmd</a> == NULL) {
00167         fprintf(stderr, <span class="stringliteral">"error starting gnuplot\n"</span>) ;
00168         free(handle) ;
00169         <span class="keywordflow">return</span> NULL ;
00170     }
00171     <span class="keywordflow">return</span> handle;
00172 }
00173 
00174 
00175 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00186 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00187 
<a name="l00188"></a><a class="code" href="gnuplot__i_8c.html#a2">00188</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a2">gnuplot_close</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * handle)
00189 {
00190     <span class="keywordtype">int</span>     i ;
00191     
00192     <span class="keywordflow">if</span> (pclose(handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m0">gnucmd</a>) == -1) {
00193         fprintf(stderr, <span class="stringliteral">"problem closing communication to gnuplot\n"</span>) ;
00194         <span class="keywordflow">return</span> ;
00195     }
00196     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a>) {
00197         <span class="keywordflow">for</span> (i=0 ; i&lt;handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> ; i++) {
00198             remove(handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m3">to_delete</a>[i]) ;
00199         }
00200     }
00201     free(handle) ;
00202     <span class="keywordflow">return</span> ;
00203 }
00204 
00205 
00206 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00229 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00230 
<a name="l00231"></a><a class="code" href="gnuplot__i_8c.html#a3">00231</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> *  handle, <span class="keywordtype">char</span> *  cmd, ...)
00232 {
00233     va_list ap ;
00234     <span class="keywordtype">char</span>    local_cmd[GP_CMD_SIZE];
00235 
00236     va_start(ap, cmd);
00237     vsprintf(local_cmd, cmd, ap);
00238     va_end(ap);
00239 
00240     strcat(local_cmd, <span class="stringliteral">"\n"</span>);
00241 
00242     fputs(local_cmd, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m0">gnucmd</a>) ;
00243     fflush(handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m0">gnucmd</a>) ;
00244     <span class="keywordflow">return</span> ;
00245 }
00246 
00247 
00248 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00268 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00269 
<a name="l00270"></a><a class="code" href="gnuplot__i_8c.html#a4">00270</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a4">gnuplot_setstyle</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * h, <span class="keywordtype">char</span> * plot_style) 
00271 {
00272     <span class="keywordflow">if</span> (strcmp(plot_style, <span class="stringliteral">"lines"</span>) &amp;&amp;
00273         strcmp(plot_style, <span class="stringliteral">"points"</span>) &amp;&amp;
00274         strcmp(plot_style, <span class="stringliteral">"linespoints"</span>) &amp;&amp;
00275         strcmp(plot_style, <span class="stringliteral">"impulses"</span>) &amp;&amp;
00276         strcmp(plot_style, <span class="stringliteral">"dots"</span>) &amp;&amp;
00277         strcmp(plot_style, <span class="stringliteral">"steps"</span>) &amp;&amp;
00278         strcmp(plot_style, <span class="stringliteral">"errorbars"</span>) &amp;&amp;
00279         strcmp(plot_style, <span class="stringliteral">"boxes"</span>) &amp;&amp;
00280         strcmp(plot_style, <span class="stringliteral">"boxerrorbars"</span>)) {
00281         fprintf(stderr, <span class="stringliteral">"warning: unknown requested style: using points\n"</span>) ;
00282         strcpy(h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>, <span class="stringliteral">"points"</span>) ;
00283     } <span class="keywordflow">else</span> {
00284         strcpy(h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>, plot_style) ;
00285     }
00286     <span class="keywordflow">return</span> ;
00287 }
00288 
00289 
00290 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00299 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00300 
<a name="l00301"></a><a class="code" href="gnuplot__i_8c.html#a5">00301</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a5">gnuplot_set_xlabel</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * h, <span class="keywordtype">char</span> * label)
00302 {
00303     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE] ;
00304 
00305     sprintf(cmd, <span class="stringliteral">"set xlabel \"%s\""</span>, label) ;
00306     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(h, cmd) ;
00307     <span class="keywordflow">return</span> ;
00308 }
00309 
00310 
00311 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00320 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00321 
<a name="l00322"></a><a class="code" href="gnuplot__i_8c.html#a6">00322</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a6">gnuplot_set_ylabel</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * h, <span class="keywordtype">char</span> * label)
00323 {
00324     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE] ;
00325 
00326     sprintf(cmd, <span class="stringliteral">"set ylabel \"%s\""</span>, label) ;
00327     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(h, cmd) ;
00328     <span class="keywordflow">return</span> ;
00329 }
00330 
00331 
00332 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00341 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00342 
<a name="l00343"></a><a class="code" href="gnuplot__i_8c.html#a7">00343</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a7">gnuplot_resetplot</a>(<a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a> * h)
00344 {
00345     <span class="keywordtype">int</span>     i ;
00346     <span class="keywordflow">if</span> (h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a>) {
00347         <span class="keywordflow">for</span> (i=0 ; i&lt;h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> ; i++) {
00348             remove(h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m3">to_delete</a>[i]) ;
00349         }
00350     }
00351     h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> = 0 ;
00352     h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> = 0 ;
00353     <span class="keywordflow">return</span> ;
00354 }
00355 
00356 
00357 
00358 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00387 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00388 
<a name="l00389"></a><a class="code" href="gnuplot__i_8c.html#a8">00389</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a8">gnuplot_plot_x</a>(
00390     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>    *   handle,
00391     <span class="keywordtype">double</span>          *   d,
00392     <span class="keywordtype">int</span>                 n,
00393     <span class="keywordtype">char</span>            *   title
00394 )
00395 {
00396     <span class="keywordtype">int</span>     i ;
00397     <span class="keywordtype">int</span>     tmpfd ;
00398     <span class="keywordtype">char</span>    name[128] ;
00399     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE] ;
00400     <span class="keywordtype">char</span>    line[GP_CMD_SIZE] ;
00401 
00402 
00403     <span class="keywordflow">if</span> (handle==NULL || d==NULL || (n&lt;1)) <span class="keywordflow">return</span> ;
00404 
00405     <span class="comment">/* Open one more temporary file? */</span>
00406     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> == GP_MAX_TMP_FILES - 1) {
00407         fprintf(stderr,
00408                 <span class="stringliteral">"maximum # of temporary files reached (%d): cannot open more"</span>,
00409                 GP_MAX_TMP_FILES) ;
00410         <span class="keywordflow">return</span> ;
00411     }
00412 
00413     <span class="comment">/* Open temporary file for output   */</span>
00414     sprintf(name, <span class="stringliteral">"%s/gnuplot-i-XXXXXX"</span>, P_tmpdir);
00415     <span class="keywordflow">if</span> ((tmpfd=mkstemp(name))==-1) {
00416         fprintf(stderr,<span class="stringliteral">"cannot create temporary file: exiting plot"</span>) ;
00417         <span class="keywordflow">return</span> ;
00418     }
00419 
00420     <span class="comment">/* Store file name in array for future deletion */</span>
00421     strcpy(handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m3">to_delete</a>[handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a>], name) ;
00422     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> ++ ;
00423     <span class="comment">/* Write data to this file  */</span>
00424     <span class="keywordflow">for</span> (i=0 ; i&lt;n ; i++) {
00425         sprintf(line, <span class="stringliteral">"%g\n"</span>, d[i]);
00426         write(tmpfd, line, strlen(line));
00427     }
00428     close(tmpfd) ;
00429 
00430     <span class="comment">/* Command to be sent to gnuplot    */</span>
00431     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> &gt; 0) {
00432         strcpy(cmd, <span class="stringliteral">"replot"</span>) ;
00433     } <span class="keywordflow">else</span> {
00434         strcpy(cmd, <span class="stringliteral">"plot"</span>) ;
00435     }
00436     
00437     <span class="keywordflow">if</span> (title == NULL) {
00438         sprintf(line, <span class="stringliteral">"%s \"%s\" with %s"</span>, cmd, name, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00439     } <span class="keywordflow">else</span> {
00440         sprintf(line, <span class="stringliteral">"%s \"%s\" title \"%s\" with %s"</span>, cmd, name,
00441                       title, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00442     }
00443 
00444     <span class="comment">/* send command to gnuplot  */</span>
00445     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(handle, line) ;
00446     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a>++ ;
00447     <span class="keywordflow">return</span> ;
00448 }
00449 
00450 
00451 
00452 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00482 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00483 
<a name="l00484"></a><a class="code" href="gnuplot__i_8c.html#a9">00484</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a9">gnuplot_plot_xy</a>(
00485     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>    *   handle,
00486     <span class="keywordtype">double</span>          *   x,
00487     <span class="keywordtype">double</span>          *   y,
00488     <span class="keywordtype">int</span>                 n,
00489     <span class="keywordtype">char</span>            *   title
00490 )
00491 {
00492     <span class="keywordtype">int</span>     i ;
00493     <span class="keywordtype">int</span>     tmpfd ;
00494     <span class="keywordtype">char</span>    name[128] ;
00495     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE] ;
00496     <span class="keywordtype">char</span>    line[GP_CMD_SIZE] ;
00497 
00498     <span class="keywordflow">if</span> (handle==NULL || x==NULL || y==NULL || (n&lt;1)) <span class="keywordflow">return</span> ;
00499 
00500     <span class="comment">/* Open one more temporary file? */</span>
00501     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> == GP_MAX_TMP_FILES - 1) {
00502         fprintf(stderr,
00503                 <span class="stringliteral">"maximum # of temporary files reached (%d): cannot open more"</span>,
00504                 GP_MAX_TMP_FILES) ;
00505         <span class="keywordflow">return</span> ;
00506     }
00507 
00508     <span class="comment">/* Open temporary file for output   */</span>
00509     sprintf(name, <span class="stringliteral">"%s/gnuplot-i-XXXXXX"</span>, P_tmpdir);
00510     <span class="keywordflow">if</span> ((tmpfd=mkstemp(name))==-1) {
00511         fprintf(stderr,<span class="stringliteral">"cannot create temporary file: exiting plot"</span>) ;
00512         <span class="keywordflow">return</span> ;
00513     }
00514     <span class="comment">/* Store file name in array for future deletion */</span>
00515     strcpy(handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m3">to_delete</a>[handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a>], name) ;
00516     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m4">ntmp</a> ++ ;
00517 
00518     <span class="comment">/* Write data to this file  */</span>
00519     <span class="keywordflow">for</span> (i=0 ; i&lt;n; i++) {
00520         sprintf(line, <span class="stringliteral">"%g %g\n"</span>, x[i], y[i]) ;
00521         write(tmpfd, line, strlen(line));
00522     }
00523     close(tmpfd) ;
00524 
00525     <span class="comment">/* Command to be sent to gnuplot    */</span>
00526     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> &gt; 0) {
00527         strcpy(cmd, <span class="stringliteral">"replot"</span>) ;
00528     } <span class="keywordflow">else</span> {
00529         strcpy(cmd, <span class="stringliteral">"plot"</span>) ;
00530     }
00531     
00532     <span class="keywordflow">if</span> (title == NULL) {
00533         sprintf(line, <span class="stringliteral">"%s \"%s\" with %s"</span>, cmd, name, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00534     } <span class="keywordflow">else</span> {
00535         sprintf(line, <span class="stringliteral">"%s \"%s\" title \"%s\" with %s"</span>, cmd, name,
00536                       title, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00537     }
00538 
00539     <span class="comment">/* send command to gnuplot  */</span>
00540     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(handle, line) ;
00541     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a>++ ;
00542     <span class="keywordflow">return</span> ;
00543 }
00544 
00545 
00546 
00547 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00566 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00567 
<a name="l00568"></a><a class="code" href="gnuplot__i_8c.html#a10">00568</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a10">gnuplot_plot_once</a>(
00569     <span class="keywordtype">char</span>    *   title,
00570     <span class="keywordtype">char</span>    *   style,
00571     <span class="keywordtype">char</span>    *   label_x,
00572     <span class="keywordtype">char</span>    *   label_y,
00573     <span class="keywordtype">double</span>  *   x,
00574     <span class="keywordtype">double</span>  *   y,
00575     <span class="keywordtype">int</span>         n
00576 )
00577 {
00578     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>    *   handle ;
00579 
00580     <span class="keywordflow">if</span> (x==NULL || n&lt;1) <span class="keywordflow">return</span> ;
00581 
00582     <span class="keywordflow">if</span> ((handle = <a class="code" href="gnuplot__i_8c.html#a1">gnuplot_init</a>()) == NULL) <span class="keywordflow">return</span> ;
00583     <span class="keywordflow">if</span> (style!=NULL) {
00584         <a class="code" href="gnuplot__i_8c.html#a4">gnuplot_setstyle</a>(handle, style);
00585     } <span class="keywordflow">else</span> {
00586         <a class="code" href="gnuplot__i_8c.html#a4">gnuplot_setstyle</a>(handle, <span class="stringliteral">"lines"</span>);
00587     }
00588     <span class="keywordflow">if</span> (label_x!=NULL) {
00589         <a class="code" href="gnuplot__i_8c.html#a5">gnuplot_set_xlabel</a>(handle, label_x);
00590     } <span class="keywordflow">else</span> {
00591         <a class="code" href="gnuplot__i_8c.html#a5">gnuplot_set_xlabel</a>(handle, <span class="stringliteral">"X"</span>);
00592     }
00593     <span class="keywordflow">if</span> (label_y!=NULL) {
00594         <a class="code" href="gnuplot__i_8c.html#a6">gnuplot_set_ylabel</a>(handle, label_y);
00595     } <span class="keywordflow">else</span> {
00596         <a class="code" href="gnuplot__i_8c.html#a6">gnuplot_set_ylabel</a>(handle, <span class="stringliteral">"Y"</span>);
00597     }
00598     <span class="keywordflow">if</span> (y==NULL) {
00599         <a class="code" href="gnuplot__i_8c.html#a8">gnuplot_plot_x</a>(handle, x, n, title);
00600     } <span class="keywordflow">else</span> {
00601         <a class="code" href="gnuplot__i_8c.html#a9">gnuplot_plot_xy</a>(handle, x, y, n, title);
00602     }
00603     printf(<span class="stringliteral">"press ENTER to continue\n"</span>);
00604     <span class="keywordflow">while</span> (getchar()!=<span class="charliteral">'\n'</span>) {}
00605     <a class="code" href="gnuplot__i_8c.html#a2">gnuplot_close</a>(handle);
00606     <span class="keywordflow">return</span> ;
00607 }
00608 
00609 
00610 
00611 
00612 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00636 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00637     
00638 
<a name="l00639"></a><a class="code" href="gnuplot__i_8c.html#a11">00639</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a11">gnuplot_plot_slope</a>(
00640     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>    *   handle,
00641     <span class="keywordtype">double</span>              a,
00642     <span class="keywordtype">double</span>              b,
00643     <span class="keywordtype">char</span>            *   title
00644 )
00645 {
00646     <span class="keywordtype">char</span>    stitle[GP_TITLE_SIZE] ;
00647     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE] ;
00648 
00649     <span class="keywordflow">if</span> (title == NULL) {
00650         strcpy(stitle, <span class="stringliteral">"no title"</span>) ;
00651     } <span class="keywordflow">else</span> {
00652         strcpy(stitle, title) ;
00653     }
00654 
00655     <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> &gt; 0) {
00656         sprintf(cmd, <span class="stringliteral">"replot %g * x + %g title \"%s\" with %s"</span>,
00657                       a, b, title, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00658     } <span class="keywordflow">else</span> {
00659         sprintf(cmd, <span class="stringliteral">"plot %g * x + %g title \"%s\" with %s"</span>,
00660                       a, b, title, handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00661     }
00662     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(handle, cmd) ;
00663     handle-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a>++ ;
00664     <span class="keywordflow">return</span> ;
00665 }
00666 
00667 
00668 <span class="comment">/*-------------------------------------------------------------------------*/</span>
00691 <span class="comment">/*--------------------------------------------------------------------------*/</span>
00692 
<a name="l00693"></a><a class="code" href="gnuplot__i_8c.html#a12">00693</a> <span class="keywordtype">void</span> <a class="code" href="gnuplot__i_8c.html#a12">gnuplot_plot_equation</a>(
00694     <a class="code" href="struct__GNUPLOT__CTRL__.html">gnuplot_ctrl</a>    *   h,
00695     <span class="keywordtype">char</span>            *   equation,
00696     <span class="keywordtype">char</span>            *   title
00697 )
00698 {
00699     <span class="keywordtype">char</span>    cmd[GP_CMD_SIZE];
00700     <span class="keywordtype">char</span>    plot_str[GP_EQ_SIZE] ;
00701     <span class="keywordtype">char</span>    title_str[GP_TITLE_SIZE] ;
00702 
00703     <span class="keywordflow">if</span> (title == NULL) {
00704         strcpy(title_str, <span class="stringliteral">"no title"</span>) ;
00705     } <span class="keywordflow">else</span> {
00706         strcpy(title_str, title) ;
00707     }
00708     <span class="keywordflow">if</span> (h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a> &gt; 0) {
00709         strcpy(plot_str, <span class="stringliteral">"replot"</span>) ;
00710     } <span class="keywordflow">else</span> {
00711         strcpy(plot_str, <span class="stringliteral">"plot"</span>) ;
00712     }
00713 
00714     sprintf(cmd, <span class="stringliteral">"%s %s title \"%s\" with %s"</span>, 
00715                   plot_str, equation, title_str, h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m2">pstyle</a>) ;
00716     <a class="code" href="gnuplot__i_8c.html#a3">gnuplot_cmd</a>(h, cmd) ;
00717     h-&gt;<a class="code" href="struct__GNUPLOT__CTRL__.html#m1">nplots</a>++ ;
00718     <span class="keywordflow">return</span> ;
00719 }
00720 
00721 <span class="comment">/* vim: set ts=4 et sw=4 tw=75 */</span>
</pre></div>
<hr>
Last modified: Mon Jan 27 10:00:38 2003
</hr>
</body>
</html>
